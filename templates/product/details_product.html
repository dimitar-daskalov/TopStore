{% extends 'shared/base.html' %}
{% load static %}
{% block content %}
    <div class="d-flex justify-content-center">
        <div class="items-container">
            <h2>Product Details</h2>
            <div class="item">
                <br>
                <h2>{{ product.name }}</h2>
                <div class="details-image"
                     style="background-image: url(
                             {% if product.product_image %}{{ product.product_image.url }}{% else %}{% static 'images/generic_product.png' %}{% endif %}
                             ) ">
                </div>
                <br>
                <h3>Description</h3>
                <div class="ta-right">
                    {% if user.is_authenticated and not user.is_staff %}
                        <a class="h2" href="{% url 'like product' product.id %}">
                            {% if is_liked %}
                                <i class="fa fa-heart" aria-hidden="true"></i>
                            {% else %}
                                <i class="far fa-heart" aria-hidden="true"></i>
                            {% endif %}
                        </a>
                    {% endif %}
                    <p class="mt-2">Likes: {{ product.likes_count }}</p>
                </div>
                <div class="product-info-full">
                    {{ product.description }}
                </div>
                <br>
                <h4 class="text-danger ta-center">Price: {{ product.price }} BGN</h4>
                <br>
                <div class="buttons-container">
                    {% if user.is_staff %}
                        <a class="btn btn btn-primary" href="{% url 'update product' product.id %}">Edit</a>
                        <a class="btn btn-danger" href="{% url 'delete product' product.id %}">Delete</a>
                    {% else %}
                        {% if user.is_authenticated %}
                            <button data-product={{ product.id }} data-action="add" class="btn btn-danger update-cart">
                                Add to Cart
                            </button>
                            <a class="btn btn btn-success" href="{% url 'store' %}">Back</a>
                        {% else %}
                            <a class="btn btn-danger" href="{% url 'sing in user' %}">Add to Cart</a>
                            <a class="btn btn btn-success" href="{% url 'store' %}">Back</a>
                        {% endif %}
                    {% endif %}
                </div>
                <br>
                <div class="d-block" style="background-color: #f1e3e3; padding:2%">
                    {% if reviews %}
                        {% for review in reviews %}
                            <div class="box">
                                <h5><u>{{ review.user }}</u>: <em>{{ review.text }}</em></h5>
                                <hr>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="box">
                            <h5>There are no reviews for this product. </h5>
                        </div>
                    {% endif %}
                    {% if user.is_authenticated and not user.is_staff %}
                        <div class="box">
                            <form method="post" action="{% url 'review product' product.id %}">
                                {% csrf_token %}
                                {{ review_form }}
                                <button class="btn btn-primary mt-2" type="submit">Add review</button>
                            </form>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}

